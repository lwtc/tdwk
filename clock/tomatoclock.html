<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tomato Clock</title>

    <link rel="stylesheet" href="./flipclock.css">
    <script src="./jquery.min.js"></script>
    <script src="./flipclock.min.js"></script>

</head>
<body>

    <div class="message" style="margin: 2em 0 2em 36px; color:red; font-size:28px"></div>
    <div class="clock-1" style="margin: 2em 0; "></div>

    <script type="text/javascript">

    var clocks = [];
    function workClock() {

        var currentDate = new Date();
        var secUp = (currentDate.getTime() / 1000) % (60*30);
        var secDown = 60*30 - secUp;
        var minFive = 60*5;

        var countDown = secDown;
        if(secDown > minFive){
            countDown = secDown - minFive;
            $('.message').html('番茄钟：工作时间');
        }else{
            $('.message').html('番茄钟：中场休息');
        }

        clocks.push($('.clock-1').FlipClock(countDown,{
            clockFace: 'MinuteCounter',
            countdown: true,
            callbacks: {
                stop: function() {
                    console.log('-- countdown stop --');
                    clocks = [];
                    workClock();
                },
                interval: function() {
                    var time = this.factory.getTime().time;
                    if(time) {
                        console.log('interval', time);
                    }
                }
            }
        }));

    }

    $(document).ready(function() {
        workClock();
    });

    </script>

</body>
</html>